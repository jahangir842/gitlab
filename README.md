## GitLab Docker Setup

This repository contains a `docker-compose.yml` file to deploy GitLab Community Edition (CE) using Docker. It also includes notes on GitLab setup, initial login credentials, and other essential configuration details.

## Overview
This project provides an easy way to set up GitLab CE locally or on a server using Docker Compose. GitLab is a web-based DevOps lifecycle tool that provides a Git repository manager with features like CI/CD, issue tracking, and more.

## Prerequisites
- Docker and Docker Compose installed on your system.
- Minimum system requirements:
  - 4GB RAM
  - 2 CPUs
  - 10GB free disk space (recommended for minimal usage)

## Setup Instructions

### Clone the Repository
```bash
git clone https://github.com/jahangir842/gitlab.git
cd gitlab
```

### Start GitLab
1. Create the necessary directories:
   ```bash
   mkdir -p config logs data
   ```
2. Start the containers:
   ```bash
   docker-compose up -d
   ```
3. Wait a few minutes for GitLab to initialize.

4. Access GitLab at `http://<your-server-ip>`.

## Configuration Details

### Default Ports
- **HTTP**: `80`
- **HTTPS**: `443`
- **SSH**: `2222`

These ports are configurable in the `docker-compose.yml` file.

GitLab uses three ports for distinct purposes:

1. **HTTP (Port 80)**: For unencrypted web traffic (default for `http://`).
2. **HTTPS (Port 443)**: For secure, encrypted web traffic (default for `https://`).
3. **SSH (Port 2222)**: For Git operations (push, pull, clone) over a secure SSH connection.

### Why Different Ports?
- **Separation of Concerns**: Web UI (HTTP/HTTPS) vs. Git operations (SSH).
- **Security**: HTTPS and SSH ensure encrypted communication.
- **Avoid Conflicts**: Port `2222` avoids clashing with host SSH (`22`) in Docker.

Use HTTPS for secure web access and SSH for secure repository management.

### Volumes
Persistent data is stored in the following directories (relative to the repository root):
- `config/`: Configuration files
- `logs/`: Logs generated by GitLab
- `data/`: Git repository and related data

### Environment Variables
Environment variables can be added or modified in the `docker-compose.yml` file to customize GitLab.

---

## Initial Login Credentials : Method 1
After the first startup, GitLab generates a root password. 

To retrieve it:
```bash
docker exec -it gitlab grep 'Password:' /etc/gitlab/initial_root_password
```

The username for the initial login is:
- **Username**: `root`

Change the password immediately after the first login.


---
## Initial Login Credentials : Method 2

### 1. **Access the Container**

Run the following command to access the container:

```
docker exec -it <gitlab container name> bash
```

### 2. **Set or Retrieve the Root Password**

Inside the container, use this command:

```
gitlab-rails console
```

- **Retrieve Password**:
  ```ruby
  user = User.where(id: 1).first
  puts user.encrypted_password
  ```
- **Set a New Password**:
  ```ruby
  user = User.where(id: 1).first
  user.password = 'YourNewPassword'
  user.password_confirmation = 'YourNewPassword'
  user.save!
  ```

Exit and test the new password.

---

## Notes
- Ensure sufficient resources are allocated to the Docker engine for smooth performance.
- For production usage:
  - Use an external database and storage.
  - Set up HTTPS with a valid SSL certificate.
- If you face health check issues, check logs using:
  ```bash
  docker logs gitlab
  ```

## References
- [GitLab Docker Documentation](https://docs.gitlab.com/omnibus/docker/)
- [GitLab Official Website](https://about.gitlab.com/)
